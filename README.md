# Pendulum

✨ **This workspace has been generated by [Nx, Smart Monorepos · Fast CI.](https://nx.dev)** ✨

## Getting Started

This project was tested with Node v20.

```
# Install dependencies
npm ci

# Run development client
npx nx serve client

# Run development server
npx nx serve server
```

### How it works

The UI process is canvas on a HTML page served by a Vite server.

Each pendulum has its own worker, composed of

- An API
- A simple pendulum simulator
- A MQTT client
- A state machine

The workers listen on port 300X.

The UI is available at http://localhost:4200/.

### How to use the GUI

1. You can move the pendulums by dragging them
2. Click on a pendulum to edit its 'mass'
3. Once you click START, you can no longer modify anything
4. Pause/Start will pause/resume the simulation
5. Stop/Start will restart the simulation
6. Don't reload the client without clicking STOP first

### Notes

We poll the 5 processes every 250ms, generating a ton of requests. Ideally, we would have a single REST API for all processes and return a couple of interpolations at once.

The collision detection algorithm isn't implemented yet, therefore it is based on randomness for now. If you leave the simulation running long enough, you will eventually trigger the stop/restart behavior.

### Todo

- Collision detection algorithm
- Tests
- Move hardcoded values to ENV variables
- Proper error handling
- Prevent dragging objects outside the canvas
- Remove event listeners when disposing the scene
- Subscribe client to state changes
